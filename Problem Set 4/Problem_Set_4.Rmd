---
title: "Problem_Set_4"
author: "Amy Richardson"
date: "3/31/2021"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#Initiate packages
```{r}
library(tidyverse)
library(ggplot2)
library(cluster)
library(factoextra)
library(dendextend)
library(dplyr)
library(tidyr)
library(psych)
library(pastecs)
```

Read in Data
```{r}
cc_df <- read.csv("2019 Compliled Data.csv", header = TRUE)
ts_df <- read.csv("VTNETSFinalv2.csv", header = TRUE)
```

In Transfer Data Set only keeping transfer from NVCC with a BS degree
```{r}
ts_df <- filter(ts_df, TransInst.Name == "Northern Va Cmty Coll-Annandal")
ts_df <- filter(ts_df, Eng.Bach.Flag == 1)
```

Remove Engineering Disciplines with n<20
```{r}
ts_df <- filter(ts_df, Eng.Major != "DOE")
ts_df <- filter(ts_df, Eng.Major != "OE")
ts_df <- filter(ts_df, Eng.Major != "MINE")
ts_df <- filter(ts_df, Eng.Major != "DAE")
ts_df <- filter(ts_df, Eng.Major != "BSE")
ts_df <- filter(ts_df, Eng.Major != "MSE")
ts_df <- filter(ts_df, Eng.Major != "CHE")
ts_df <- filter(ts_df, Eng.Major != "ISE")
ts_df <- filter(ts_df, Eng.Major != "ESM")
```



```{r}
tsData_sub <- ts_df %>%
  select(Gender, NumberofCredits, Eng.Major, GPA, TotalSemesterTimetoDegree, FullTimeSemstoDegree) 
```


Histograms 
```{r}
tsData_sub %>%
  ggplot(aes(x = NumberofCredits, fill = Eng.Major)) +
  geom_histogram () +
  facet_grid(Eng.Major ~., scales = "free") 
```


By Gender
```{r}
tsData_sub %>%
  ggplot(aes(x = NumberofCredits, fill = Gender)) +
  geom_histogram ()
  facet_grid(Eng.Major ~., scales = "free") 
```

```{r}
describe(ts_df$NumberofCredits)
by(ts_df$NumberofCredits, ts_df$Eng.Major, stat.desc)
```

Q-Q Plot of Transfer Credit
```{r}
qqplot.tsCredit <- qplot(sample = tsData_sub$NumberofCredits, stat="qq")
qqplot.tsCredit + stat_qq_line()+
  labs(title = "QQPlot for Transfer Credit", x = "Thoeretical", y = "Sample")
```

Shappiro-Wilks Test
```{r}
shapiro.test(tsData_sub$NumberofCredits)
```


Plot boxplots of transfer credits by engineering discipline
```{r}
tsData_sub %>% 
  ggplot(aes(x = Eng.Major, y = NumberofCredits)) +
  geom_boxplot() +
  labs(title = "Boxplot of Transfer Credit  by Engineering Discipline",
       x ="Engineering Discipline",
       y = "Number of Transfer Credits") +
  theme(plot.title = element_text(hjust = 0.5))

```
Plot boxplots of transfer credits by gender
```{r}
tsData_sub %>% 
  ggplot(aes(x = Gender, y = NumberofCredits)) +
  geom_boxplot() +
  labs(title = "Boxplot of Transfer Credit  by Gender",
       x ="Gender",
       y = "Number of Transfer Credits") +
  theme(plot.title = element_text(hjust = 0.5))
```





KMeans - DOES NOT WORK
```{r}
Use K-Means for cluster analysis
```{r}
k2 <- kmeans(tsData_sub, center = 2, nstart = 25)
k2
```



Change Variables to Factors
```{r}
cc_df <- cc_df %>% mutate(School= as.factor(School))
cc_df <âˆ’ cc_df %>% mutate(Dress.Size = as.numeric(Dress.Size))

```

Use K-Means for cluster analysis
```{r}
k2 <- kmeans(cc_df, center = 2, nstart = 25)
k2
```
