View(mean_df)
View(mean_df)
mean_df <- inner_join(Loc_df,zonei_df)
kmeans_basic_df2 <- inner_join(kmeans_basic_df, zonei_df)
mean_df <- select(mean_df, Zone, PULocationID, trip_distance, total_amount, Borough)
mean_df <- select(mean_df, Zone, trip_distance, total_amount, Borough)
mean_df <- select(mean_df, Zone, Borough, trip_distance, total_amount, )
k2 <- kmeans(mean_df[,3:4], centers = 2, nstart = 25)
# plots to compare
p1 <- fviz_cluster(k2, geom = "point", data = mean_df2) + ggtitle("k = 2")
View(k2)
mean_df <- Loc_df %>% group_by(Zone) %>%
summarise_at(vars(-PULocationID), funs(mean(., na.rm=TRUE)))
.
mean_df <- filter(mean_df, Zone != "NV")
mean_df <- select(mean_df, Zone, Borough, trip_distance, total_amount, )
mean_df <- inner_join(Loc_df,zonei_df)
mean_df <- select(mean_df, Zone, Borough, trip_distance, total_amount, )
mean_df <- Loc_df %>% group_by(Zone) %>%
summarise_at(vars(-PULocationID), funs(mean(., na.rm=TRUE)))
Loc_df <- merge(taxi_sub, zonei_df, by.x = "PULocationID", by.y = "LocationID")
Loc_df <- select(Loc_df, Zone, PULocationID, trip_distance, total_amount)
Loc_df <- filter(Loc_df, trip_distance > 0)
Loc_df<- filter(Loc_df, total_amount > 0 )
mean_df <- Loc_df %>% group_by(Zone) %>%
summarise_at(vars(-PULocationID), funs(mean(., na.rm=TRUE)))
mean_df <- filter(mean_df, Zone != "NV")
mean_df <- inner_join(Loc_df,zonei_df)
mean_df <- select(mean_df, Zone, Borough, trip_distance, total_amount, )
Loc_df <- merge(taxi_sub, zonei_df, by.x = "PULocationID", by.y = "LocationID")
Loc_df <- select(Loc_df, Zone, PULocationID, trip_distance, total_amount)
Loc_df <- filter(Loc_df, trip_distance > 0)
Loc_df<- filter(Loc_df, total_amount > 0 )
mean_df <- Loc_df %>% group_by(Zone) %>%
summarise_at(vars(-PULocationID), funs(mean(., na.rm=TRUE)))
mean_df <- filter(mean_df, Zone != "NV")
mean_df <- inner_join(mean_df,zonei_df)
mean_df <- select(mean_df, Zone, Borough, trip_distance, total_amount, )
set.seed(123)
final <- kmeans(mean_df[,3:4], 4, nstart = 25)
print(final)
fviz_cluster(final, data = mean_df[,3:4])
fviz_cluster(final, data = mean_df[,3:4])
k2 <- kmeans(mean_df[,3:4], centers = 2, nstart = 25)
k3 <- kmeans(mean_df[,3:4], centers = 3, nstart = 25)
k4 <- kmeans(mean_df[,3:4], centers = 4, nstart = 25)
k5 <- kmeans(mean_df[,3:4], centers = 5, nstart = 25)
# plots to compare
p1 <- fviz_cluster(k2, geom = "point", data = mean_df[,3:4]) + ggtitle("k = 2")
p2 <- fviz_cluster(k3, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 3")
p3 <- fviz_cluster(k4, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 4")
p4 <- fviz_cluster(k5, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 5")
library(gridExtra)
grid.arrange(p1, p2, p3, p4, nrow = 2)
set.seed(123)
fviz_nbclust(mean_df[,3:4], kmeans, method = "wss")
fviz_nbclust(mean_df[,3:4], kmeans, method = "silhouette")
set.seed(123)
gap_stat <- clusGap(mean_df[,3:4], FUN = kmeans, nstart = 25,
K.max = 10, B = 50)
fviz_gap_stat(gap_stat)
mean_group_df %>%
mutate(Cluster = final$cluster) %>%
group_by(Cluster) %>%
summarise_all("mean")
mean_df %>%
mutate(Cluster = final$cluster) %>%
group_by(Cluster) %>%
summarise_all("mean")
distance <- get_dist(mean_df[,3:4])
fviz_dist(distance, gradient = list(low = "#00AFBB", mid = "white", high = "#FC4E07"))
k4_2 <- kmeans(mean_df[,3:4], centers = 4)
kmeans_basic_table <- data.frame(k4_2$size, k4_2$centers)
kmeans_basic_df <- data.frame(Cluster = k4_2$cluster, mean_df)
# head of df
head(kmeans_basic_df)
ggplot(data = kmeans_basic_df, aes(y = Cluster)) +
geom_bar(aes(fill = Borough)) +
ggtitle("Count of Clusters by Borough") +
theme(plot.title = element_text(hjust = 0.5))
k2 <- kmeans(mean_df[,3:4], centers = 2, nstart = 25)
k3 <- kmeans(mean_df[,3:4], centers = 3, nstart = 25)
k4 <- kmeans(mean_df[,3:4], centers = 4, nstart = 25)
k5 <- kmeans(mean_df[,3:4], centers = 5, nstart = 25)
# plots to compare
p1 <- fviz_cluster(k2, geom = "point", data = mean_df[,3:4]) + ggtitle("k = 2")
p2 <- fviz_cluster(k3, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 3")
p3 <- fviz_cluster(k4, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 4")
p4 <- fviz_cluster(k5, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 5")
library(gridExtra)
grid.arrange(p1, p2, p3, p4, nrow = 2)
set.seed(123)
final <- kmeans(mean_df[,3:4], 4, nstart = 25)
print(final)
distance <- get_dist(mean_df[,3:4])
fviz_dist(distance, gradient = list(low = "#00AFBB", mid = "white", high = "#FC4E07"))
knitr::opts_chunk$set(echo = TRUE)
degree_all <- read.csv("VTNETSFinal.csv", header = TRUE)
degree_all<- filter(degree_all, TransInst.Name != "NA")
degree_all <- filter(degree_all, Eng.Bach.Flag == 1)
vccs_df <- filter(degree_all, TransInst.Name == "New River Community College" | TransInst.Name == "Northern Va Cmty Coll-Annandal" | TransInst.Name == "Eastern Shore Community Coll"| TransInst.Name == "Virginia Western Cmty Coll" | TransInst.Name == "Tidewater Cmty Coll Nrflk-Main" | TransInst.Name == "Southwest Virginia Cmty Coll" | TransInst.Name ==  "J Sargeant Reynolds Cmty Coll" | TransInst.Name ==  "Piedmont Virginia Cmty College" | TransInst.Name ==  "Central Virginia Community Col" | TransInst.Name ==  "Thomas Nelson Community Coll" | TransInst.Name ==  "Germanna Community College" | TransInst.Name ==  "Danville Community College" | TransInst.Name ==  "Blue Ridge Cmty College VA" | TransInst.Name == "Patrick Henry Community Coll" | TransInst.Name =="Dabney Lancaster Cmty College" | TransInst.Name =="John Tyler Community College" | TransInst.Name == "Lord Fairfax Community Coll"  | TransInst.Name == "Mountain Empire Cmty College" | TransInst.Name == "Rappahannock Community College" | TransInst.Name == "Southside VA Cmty Coll Alberta" | TransInst.Name == "Virginia Highlands Cmty Coll" | TransInst.Name =="Wytheville Community College")
View(vccs_df)
View(vccs_df)
k2 <- kmeans(mean_df[,3:4], centers = 2, nstart = 25)
k3 <- kmeans(mean_df[,3:4], centers = 3, nstart = 25)
k4 <- kmeans(mean_df[,3:4], centers = 4, nstart = 25)
k5 <- kmeans(mean_df[,3:4], centers = 5, nstart = 25)
k6 <- kmeans(mean_df[,3:4], centers = 6, nstart = 25)
k7 <- kmeans(mean_df[,3:4], centers = 7, nstart = 25)
k8 <- kmeans(mean_df[,3:4], centers = 8, nstart = 25)
k9 <- kmeans(mean_df[,3:4], centers = 9, nstart = 25)
k10 <- kmeans(mean_df[,3:4], centers = 10, nstart = 25)
# plots to compare
p1 <- fviz_cluster(k2, geom = "point", data = mean_df[,3:4]) + ggtitle("k = 2")
p2 <- fviz_cluster(k3, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 3")
p3 <- fviz_cluster(k4, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 4")
p4 <- fviz_cluster(k5, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 5")
p5 <- fviz_cluster(k6, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 6")
p6 <- fviz_cluster(k7, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 7")
p7 <- fviz_cluster(k8, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 8")
p8 <- fviz_cluster(k9, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 9")
p9 <- fviz_cluster(k10, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 10")
library(gridExtra)
grid.arrange(p1, p2, p3, p4, p5, p6, p7, p8, p9, nrow = 2)
grid.arrange(p1, p2, p3, p4, p5, p6, p7, p8, p9, nrow = 5)
grid.arrange(p1, p2, p3, p4, nrow = 2)
grid.arrange(p5, p6, p7, p8, p9, nrow = 5)
grid.arrange(p5, p6, p7, p8, p9, nrow = 3)
grid.arrange(p1, p2, p3, p4, nrow = 2)
grid.arrange(p5, p6, p7, p8, p9, nrow = 3)
set.seed(123)
fviz_nbclust(mean_df[,3:4], kmeans, method = "wss")
p3
set.seed(123)
final <- kmeans(mean_df[,3:4], 5, nstart = 25)
fviz_cluster(final, data = mean_df[,3:4])
set.seed(123)
final <- kmeans(mean_df[,3:4], 6, nstart = 25)
fviz_cluster(final, data = mean_df[,3:4])
set.seed(123)
final <- kmeans(mean_df[,3:4], 4, nstart = 25)
fviz_cluster(final, data = mean_df[,3:4])
p3 <- fviz_cluster(k4, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 4")
p3
k2 <- kmeans(mean_df[,3:4], nstart = 25)
# plots to compare
p1 <- fviz_cluster(k2, geom = "point", data = mean_df[,3:4]) + ggtitle("k = 2")
grid.arrange(p1, p2, p3, p4, nrow = 2)
k2 <- kmeans(mean_df[,3:4], 2, nstart = 25)
k3 <- kmeans(mean_df[,3:4], 3, nstart = 25)
k4 <- kmeans(mean_df[,3:4], 4, nstart = 25)
k5 <- kmeans(mean_df[,3:4], 5, nstart = 25)
k6 <- kmeans(mean_df[,3:4], 6, nstart = 25)
k7 <- kmeans(mean_df[,3:4], 7, nstart = 25)
k8 <- kmeans(mean_df[,3:4], 8, nstart = 25)
k9 <- kmeans(mean_df[,3:4], 9, nstart = 25)
k10 <- kmeans(mean_df[,3:4], 10, nstart = 25)
# plots to compare
p1 <- fviz_cluster(k2, geom = "point", data = mean_df[,3:4]) + ggtitle("k = 2")
p2 <- fviz_cluster(k3, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 3")
p3 <- fviz_cluster(k4, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 4")
p4 <- fviz_cluster(k5, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 5")
p5 <- fviz_cluster(k6, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 6")
p6 <- fviz_cluster(k7, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 7")
p7 <- fviz_cluster(k8, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 8")
p8 <- fviz_cluster(k9, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 9")
p9 <- fviz_cluster(k10, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 10")
grid.arrange(p1, p2, p3, p4, nrow = 2)
grid.arrange(p5, p6, p7, p8, p9, nrow = 3)
p3 <- fviz_cluster(k4, data = mean_df[,3:4]) + ggtitle("k = 4")
p3
p3 <- fviz_cluster(k4, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 4")
p3
set.seed(123)
final <- kmeans(mean_df[,3:4], center = 4, nstart = 25)
print(final)
fviz_cluster(final, data = mean_df[,3:4])
set.seed(123)
final <- kmeans(mean_df[,3:4], 4, nstart = 25)
fviz_cluster(final, data = mean_df[,3:4])
set.seed(123)
k2 <- kmeans(mean_df[,3:4], 2, nstart = 25)
k3 <- kmeans(mean_df[,3:4], 3, nstart = 25)
k4 <- kmeans(mean_df[,3:4], 4, nstart = 25)
k5 <- kmeans(mean_df[,3:4], 5, nstart = 25)
k6 <- kmeans(mean_df[,3:4], 6, nstart = 25)
k7 <- kmeans(mean_df[,3:4], 7, nstart = 25)
k8 <- kmeans(mean_df[,3:4], 8, nstart = 25)
k9 <- kmeans(mean_df[,3:4], 9, nstart = 25)
k10 <- kmeans(mean_df[,3:4], 10, nstart = 25)
# plots to compare
p1 <- fviz_cluster(k2, geom = "point", data = mean_df[,3:4]) + ggtitle("k = 2")
p2 <- fviz_cluster(k3, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 3")
p3 <- fviz_cluster(k4, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 4")
p4 <- fviz_cluster(k5, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 5")
p5 <- fviz_cluster(k6, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 6")
p6 <- fviz_cluster(k7, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 7")
p7 <- fviz_cluster(k8, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 8")
p8 <- fviz_cluster(k9, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 9")
p9 <- fviz_cluster(k10, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 10")
grid.arrange(p1, p2, p3, p4, nrow = 2)
grid.arrange(p5, p6, p7, p8, p9, nrow = 3)
p3 <- fviz_cluster(k4, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 4")
p3
# Cluster Analysis - kmeans
k4_2 <- kmeans(mean_df[,3:4], centers = 4)
kmeans_basic_table <- data.frame(k4_2$size, k4_2$centers)
kmeans_basic_df <- data.frame(Cluster = k4_2$cluster, mean_df)
# head of df
head(kmeans_basic_df)
ggplot(data = kmeans_basic_df, aes(y = Cluster)) +
geom_bar(aes(fill = Borough)) +
ggtitle("Count of Clusters by Borough") +
theme(plot.title = element_text(hjust = 0.5))
# Cluster Analysis - kmeans
k4_2 <- kmeans(mean_df[,3:4], 4)
kmeans_basic_table <- data.frame(k4_2$size, k4_2$centers)
kmeans_basic_df <- data.frame(Cluster = k4_2$cluster, mean_df)
# head of df
head(kmeans_basic_df)
ggplot(data = kmeans_basic_df, aes(y = Cluster)) +
geom_bar(aes(fill = Borough)) +
ggtitle("Count of Clusters by Borough") +
theme(plot.title = element_text(hjust = 0.5))
set.seed(123)
final <- kmeans(mean_df[,3:4], 4, nstart = 25)
print(final)
fviz_cluster(final, data = mean_df[,3:4])
mean_df %>%
mutate(Cluster = final$cluster) %>%
group_by(Cluster) %>%
summarise_all("mean")
set.seed(123)
final <- kmeans(mean_df[,3:4], 4, nstart = 25)
fviz_cluster(final, data = mean_df[,3:4])
mean_df %>%
mutate(Cluster = final$cluster) %>%
group_by(Cluster) %>%
summarise_all("mean")
# Cluster Analysis - kmeans
k4_2 <- kmeans(mean_df[,3:4], 4)
kmeans_basic_table <- data.frame(k4_2$size, k4_2$centers)
kmeans_basic_df <- data.frame(Cluster = k4_2$cluster, mean_df)
# head of df
head(kmeans_basic_df)
ggplot(data = kmeans_basic_df, aes(y = Cluster)) +
geom_bar(aes(fill = Borough)) +
ggtitle("Count of Clusters by Borough") +
theme(plot.title = element_text(hjust = 0.5))
View(taxi_sub)
View(taxi_df)
setwd("C:/Users/Amy Richardson/Dropbox/VT - PhD/ENGE 5714 - Quant/R Practice/ENGE5714/Problem Set 4")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(cluster)
library(factoextra)
library(dendextend)
library(dplyr)
library(tidyr)
library(psych)
library(pastecs)
library(car)
library(ggpubr)
library(pgirmess)
library(gridExtra)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(cluster)
library(factoextra)
library(dendextend)
library(dplyr)
library(tidyr)
library(psych)
library(pastecs)
library(car)
library(ggpubr)
library(pgirmess)
library(gridExtra)
taxi_df <- read.csv("yellow_tripdata_2019-11.csv", header = TRUE)
zonei_df <- read.csv("taxi+_zone_lookup.csv", header = TRUE)
taxi_sub <- select(taxi_df, PULocationID, trip_distance, total_amount)
Loc_df <- merge(taxi_sub, zonei_df, by.x = "PULocationID", by.y = "LocationID")
Loc_df <- select(Loc_df, Zone, PULocationID, trip_distance, total_amount)
Loc_df <- filter(Loc_df, trip_distance > 0)
Loc_df<- filter(Loc_df, total_amount > 0 )
mean_df <- Loc_df %>% group_by(Zone) %>%
summarise_at(vars(-PULocationID), funs(mean(., na.rm=TRUE)))
mean_df <- filter(mean_df, Zone != "NV")
mean_df <- inner_join(mean_df,zonei_df)
mean_df <- select(mean_df, Zone, Borough, trip_distance, total_amount, )
distance <- get_dist(mean_df[,3:4])
fviz_dist(distance, gradient = list(low = "#00AFBB", mid = "white", high = "#FC4E07"))
set.seed(123)
k2 <- kmeans(mean_df[,3:4], 2, nstart = 25)
k3 <- kmeans(mean_df[,3:4], 3, nstart = 25)
k4 <- kmeans(mean_df[,3:4], 4, nstart = 25)
k5 <- kmeans(mean_df[,3:4], 5, nstart = 25)
k6 <- kmeans(mean_df[,3:4], 6, nstart = 25)
k7 <- kmeans(mean_df[,3:4], 7, nstart = 25)
k8 <- kmeans(mean_df[,3:4], 8, nstart = 25)
k9 <- kmeans(mean_df[,3:4], 9, nstart = 25)
k10 <- kmeans(mean_df[,3:4], 10, nstart = 25)
# plots to compare
p1 <- fviz_cluster(k2, geom = "point", data = mean_df[,3:4]) + ggtitle("k = 2")
p2 <- fviz_cluster(k3, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 3")
p3 <- fviz_cluster(k4, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 4")
p4 <- fviz_cluster(k5, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 5")
p5 <- fviz_cluster(k6, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 6")
p6 <- fviz_cluster(k7, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 7")
p7 <- fviz_cluster(k8, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 8")
p8 <- fviz_cluster(k9, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 9")
p9 <- fviz_cluster(k10, geom = "point",  data = mean_df[,3:4]) + ggtitle("k = 10")
grid.arrange(p1, p2, p3, p4, nrow = 2)
grid.arrange(p5, p6, p7, p8, p9, nrow = 3)
set.seed(123)
fviz_nbclust(mean_df[,3:4], kmeans, method = "wss")
fviz_nbclust(mean_df[,3:4], kmeans, method = "silhouette")
set.seed(123)
gap_stat <- clusGap(mean_df[,3:4], FUN = kmeans, nstart = 25,
K.max = 10, B = 50)
fviz_gap_stat(gap_stat)
set.seed(123)
final <- kmeans(mean_df[,3:4], 4, nstart = 25)
fviz_cluster(final, data = mean_df[,3:4])
mean_df %>%
mutate(Cluster = final$cluster) %>%
group_by(Cluster) %>%
summarise_all("mean")
# Cluster Analysis - kmeans
k4_2 <- kmeans(mean_df[,3:4], 4)
kmeans_basic_table <- data.frame(k4_2$size, k4_2$centers)
kmeans_basic_df <- data.frame(Cluster = k4_2$cluster, mean_df)
# head of df
head(kmeans_basic_df)
ggplot(data = kmeans_basic_df, aes(y = Cluster)) +
geom_bar(aes(fill = Borough)) +
ggtitle("Count of Clusters by Borough") +
theme(plot.title = element_text(hjust = 0.5))
View(taxi_sub)
View(Loc_df)
loc_df <- inner_join(mean_df,zonei_df)
View(Loc_df)
View(loc_df)
taxi_df <- read.csv("yellow_tripdata_2019-11.csv", header = TRUE)
zonei_df <- read.csv("taxi+_zone_lookup.csv", header = TRUE)
taxi_sub <- select(taxi_df, PULocationID, trip_distance, total_amount)
Loc_df <- merge(taxi_sub, zonei_df, by.x = "PULocationID", by.y = "LocationID")
Loc_df <- select(Loc_df, Zone, PULocationID, trip_distance, total_amount)
Loc_df <- filter(Loc_df, trip_distance > 0)
Loc_df<- filter(Loc_df, total_amount > 0 )
loc_df <- inner_join(mean_df,zonei_df)
loc_df <- inner_join(Loc_df,zonei_df)
library(tidyverse)
library(ggplot2)
library(cluster)
library(factoextra)
library(dendextend)
library(dplyr)
library(tidyr)
library(psych)
library(pastecs)
library(car)
library(ggpubr)
library(pgirmess)
library(gridExtra)
taxi_df <- read.csv("yellow_tripdata_2019-11.csv", header = TRUE)
zonei_df <- read.csv("taxi+_zone_lookup.csv", header = TRUE)
taxi_sub <- select(taxi_df, PULocationID, trip_distance, total_amount)
Loc_df <- merge(taxi_sub, zonei_df, by.x = "PULocationID", by.y = "LocationID")
Loc_df <- select(Loc_df, Zone, PULocationID, trip_distance, total_amount)
Loc_df <- filter(Loc_df, trip_distance > 0)
Loc_df<- filter(Loc_df, total_amount > 0 )
Loc_df <- inner_join(Loc_df,zonei_df)
View(Loc_df)
Loc_df <- select(Loc_df, Zone, Borough, PULocationID, trip_distance, total_amount)
distance <- get_dist(Loc_df[,4:5])
Loc_scale <- scale(Loc_df$trip_distance)
Loc_scale <- scale(Loc_df$total_amount)
View(Loc_scale)
Loc_scale <- scale(Loc_df)
View(Loc_scale)
View(Loc_scale)
Loc_scale <- lapply(Loc_df[,4:5],normalized,na.rm= TRUE)
library(dplyr)
Loc_scale <- lapply(Loc_df[,4:5],normalized,na.rm= TRUE)
Loc_scale <- Loc_df %>%
mutate_at(c("trip_distance", "total_amount"), ~(scale(.) %>% as.vector))
head(data_scale2)
View(Loc_scale)
Loc_scale <- lapply(Loc_df[,4:5],normalized,na.rm= TRUE)
Loc_scale <- Loc_df %>%
mutate_at(c("trip_distance", "total_amount"), ~(scale(.) %>% as.vector))
distance <- get_dist(Loc_scale[,4:5])
set.seed(123)
k2 <- kmeans(Loc_scale [,3:4], 2, nstart = 25)
k3 <- kmeans(Loc_scale [,3:4], 3, nstart = 25)
k4 <- kmeans(Loc_scale [,3:4], 4, nstart = 25)
k5 <- kmeans(Loc_scale [,3:4], 5, nstart = 25)
k6 <- kmeans(Loc_scale [,3:4], 6, nstart = 25)
k7 <- kmeans(Loc_scale [,3:4], 7, nstart = 25)
k8 <- kmeans(Loc_scale [,3:4], 8, nstart = 25)
k9 <- kmeans(Loc_scale [,3:4], 9, nstart = 25)
k10 <- kmeans(Loc_scale [,3:4], 10, nstart = 25)
p1 <- fviz_cluster(k2, geom = "point", data = mean_df[,3:4]) + ggtitle("k = 2")
set.seed(123)
k2 <- kmeans(Loc_scale [,4:5], 2, nstart = 25)
k3 <- kmeans(Loc_scale [,4:5], 3, nstart = 25)
k4 <- kmeans(Loc_scale [,4:5], 4, nstart = 25)
k5 <- kmeans(Loc_scale [,4:5], 5, nstart = 25)
k6 <- kmeans(Loc_scale [,4:5], 6, nstart = 25)
k7 <- kmeans(Loc_scale [,4:5], 7, nstart = 25)
k8 <- kmeans(Loc_scale [,4:5], 8, nstart = 25)
k9 <- kmeans(Loc_scale [,4:5], 9, nstart = 25)
k10 <- kmeans(Loc_scale [,4:5], 10, nstart = 25)
# plots to compare
p1 <- fviz_cluster(k2, geom = "point", Loc_scale [,4:5]) + ggtitle("k = 2")
p2 <- fviz_cluster(k3, geom = "point", Loc_scale [,4:5]) + ggtitle("k = 3")
p3 <- fviz_cluster(k4, geom = "point", Loc_scale [,4:5]) + ggtitle("k = 4")
p4 <- fviz_cluster(k5, geom = "point", Loc_scale [,4:5]) + ggtitle("k = 5")
p5 <- fviz_cluster(k6, geom = "point", Loc_scale [,4:5]) + ggtitle("k = 6")
p6 <- fviz_cluster(k7, geom = "point", Loc_scale [,4:5]) + ggtitle("k = 7")
p7 <- fviz_cluster(k8, geom = "point", Loc_scale [,4:5])+ ggtitle("k = 8")
p8 <- fviz_cluster(k9, geom = "point", Loc_scale [,4:5]) + ggtitle("k = 9")
p9 <- fviz_cluster(k10, geom = "point", Loc_scale [,4:5]) + ggtitle("k = 10")
grid.arrange(p1, p2, p3, p4, nrow = 2)
grid.arrange(p5, p6, p7, p8, p9, nrow = 3)
set.seed(123)
fviz_nbclust(Loc_scale [,4:5], kmeans, method = "wss")
fviz_nbclust(Loc_scale [,4:5], kmeans, method = "silhouette")
View(Loc_scale)
View(Loc_scale)
Loc_scale%>%
ggplot(aes(x = trip_distance)) +
geom_histogram ()
Loc_df%>%
ggplot(aes(x = trip_distance)) +
geom_histogram ()
Loc_df%>%
ggplot(aes(x = total_amount)) +
geom_histogram ()
Loc_df %>%
ggplot(aes(x = trip_distance, fill = Borough)) +
geom_histogram () +
facet_grid(Borough ~., scales = "free")
Loc_df <- filter(Loc_df, Borough == "EWR")
Loc_df <- filter(Loc_df, Borough != "EWR")
taxi_sub <- select(taxi_df, PULocationID, trip_distance, total_amount)
Loc_df <- merge(taxi_sub, zonei_df, by.x = "PULocationID", by.y = "LocationID")
Loc_df <- select(Loc_df, Zone, PULocationID, trip_distance, total_amount)
Loc_df <- filter(Loc_df, trip_distance > 0)
Loc_df<- filter(Loc_df, total_amount > 0 )
Loc_df <- filter(Loc_df, Borough != "EWR")
Loc_df <- inner_join(Loc_df,zonei_df)
Loc_df <- select(Loc_df, Zone, Borough, PULocationID, trip_distance, total_amount)
Loc_df <- filter(Loc_df, Borough != "EWR")
describe(Loc_df$trip_distance)
by(Loc_df$trip_distance, Loc_df$Borough, stat.desc)
Loc_df <- filter(Loc_df, Borough != "Unknown")
Loc_scale <- Loc_df %>%
mutate_at(c("trip_distance", "total_amount"), ~(scale(.) %>% as.vector))
describe(Loc_df$trip_distance)
by(Loc_df$trip_distance, Loc_df$Borough, stat.desc)
Loc_df <- filter(Loc_df, trip_distance > 0.2)
Loc_df<- filter(Loc_df, total_amount > 0 )
Loc_df <- merge(taxi_sub, zonei_df, by.x = "PULocationID", by.y = "LocationID")
Loc_df <- select(Loc_df, Zone, PULocationID, trip_distance, total_amount)
Loc_df <- filter(Loc_df, trip_distance > 0.1)
Loc_df<- filter(Loc_df, total_amount > 0 )
Loc_df <- inner_join(Loc_df,zonei_df)
Loc_df <- select(Loc_df, Zone, Borough, PULocationID, trip_distance, total_amount)
Loc_df <- filter(Loc_df, Borough != "EWR")
Loc_df <- filter(Loc_df, Borough != "Unknown")
describe(Loc_df$trip_distance)
by(Loc_df$trip_distance, Loc_df$Borough, stat.desc)
Loc_df <- filter(Loc_df, trip_distance < 100)
describe(Loc_df$trip_distance)
by(Loc_df$trip_distance, Loc_df$Borough, stat.desc)
Loc_scale <- Loc_df %>%
mutate_at(c("trip_distance", "total_amount"), ~(scale(.) %>% as.vector))
sample_n(loc_df, 100000)
Loc_df2 <- sample_n(Loc_df, 100000)
View(Loc_df2)
Loc_scale <- Loc_df2 %>%
mutate_at(c("trip_distance", "total_amount"), ~(scale(.) %>% as.vector))
describe(Loc_df2$trip_distance)
by(Loc_df2$trip_distance, Loc_df$Borough, stat.desc)
describe(Loc_df2$trip_distance)
by(Loc_df2$trip_distance, Loc_df2$Borough, stat.desc)
distance <- get_dist(Loc_scale[,4:5])
set.seed(123)
k2 <- kmeans(Loc_scale [,4:5], 2, nstart = 25)
k3 <- kmeans(Loc_scale [,4:5], 3, nstart = 25)
k4 <- kmeans(Loc_scale [,4:5], 4, nstart = 25)
k5 <- kmeans(Loc_scale [,4:5], 5, nstart = 25)
k6 <- kmeans(Loc_scale [,4:5], 6, nstart = 25)
k7 <- kmeans(Loc_scale [,4:5], 7, nstart = 25)
k8 <- kmeans(Loc_scale [,4:5], 8, nstart = 25)
k9 <- kmeans(Loc_scale [,4:5], 9, nstart = 25)
k10 <- kmeans(Loc_scale [,4:5], 10, nstart = 25)
# plots to compare
p1 <- fviz_cluster(k2, geom = "point", Loc_scale [,4:5]) + ggtitle("k = 2")
p2 <- fviz_cluster(k3, geom = "point", Loc_scale [,4:5]) + ggtitle("k = 3")
p3 <- fviz_cluster(k4, geom = "point", Loc_scale [,4:5]) + ggtitle("k = 4")
p4 <- fviz_cluster(k5, geom = "point", Loc_scale [,4:5]) + ggtitle("k = 5")
p5 <- fviz_cluster(k6, geom = "point", Loc_scale [,4:5]) + ggtitle("k = 6")
p6 <- fviz_cluster(k7, geom = "point", Loc_scale [,4:5]) + ggtitle("k = 7")
p7 <- fviz_cluster(k8, geom = "point", Loc_scale [,4:5])+ ggtitle("k = 8")
p8 <- fviz_cluster(k9, geom = "point", Loc_scale [,4:5]) + ggtitle("k = 9")
p9 <- fviz_cluster(k10, geom = "point", Loc_scale [,4:5]) + ggtitle("k = 10")
grid.arrange(p1, p2, p3, p4, nrow = 2)
